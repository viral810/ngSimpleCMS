// angular-paginate-anything - v2.4.0
!function(){"use strict";function a(a){var b=[1,2.5,5];return Math.floor(Math.pow(10,Math.floor(a/3))*b[a%3])}function b(a){if(1>a)return 0;var b=Math.floor(Math.log(a)/Math.LN10),c=a/(2.5*Math.pow(10,b));return c>=3&&(b++,c=0),3*b+Math.round(Math.min(2,c))}function c(c){return 1/0===c?1/0:a(b(c))}function d(a){var b=a&&a.match(/^(\d+)-(\d+)\/(\d+|\*)$/);return b?{from:+b[1],to:+b[2],total:"*"===b[3]?1/0:+b[3]}:null}function e(a){return a.to-a.from+1}angular.module("begriffs.paginate-anything",[]).directive("begriffs.pagination",function(){return{restrict:"E",scope:{url:"=",headers:"&",collection:"=",page:"=?",perPage:"=?",perPagePresets:"=?",autoPresets:"=?",clientLimit:"=?",linkGroupSize:"=?",reloadPage:"=?",passive:"@",numPages:"=?",numItems:"=?",serverLimit:"=?"},templateUrl:function(a,b){return b.templateUrl||"tpl/paginate-anything.html"},replace:!0,controller:["$scope","$http",function(f,g){function h(c){g({method:"GET",url:f.url,headers:angular.extend({},f.headers,{"Range-Unit":"items",Range:[c.from,c.to].join("-")})}).success(function(g,h,i,j){f.collection=g;var k=d(i("Content-Range"));if(f.numItems=k?k.total:g.length,k){if(e(k)<k.total&&(f.paginated=!0,(c.to<k.total-1||k.to<k.total-1&&k.total<c.to)&&(!f.perPage||e(k)<f.perPage))){if(f.autoPresets){var l=b(e(k));a(l)>e(k)&&l--,f.serverLimit=a(l)}else f.serverLimit=e(k);f.perPage=f.Math.min(f.serverLimit,f.clientLimit)}f.numPages=Math.ceil(k.total/(f.perPage||1))}f.$emit("pagination:loadPage",h,j)}).error(function(a,b,c,d){f.$emit("pagination:error",b,d)})}f.reloadPage=!1,f.paginated=!1,f.serverLimit=1/0,f.Math=window.Math,"boolean"!=typeof f.autoPresets&&(f.autoPresets=!0);var i=f.linkGroupSize,j=f.clientLimit;f.linkGroupSize="number"==typeof i?i:3,f.clientLimit="number"==typeof j?j:250,f.updatePresets=function(){if(f.autoPresets){var c,d=[];for(c=Math.min(3,b(f.perPage||250));c<=b(Math.min(f.clientLimit,f.serverLimit));c++)d.push(a(c));f.perPagePresets=d}else f.perPagePresets=f.perPagePresets.filter(function(a){return a<=f.serverLimit}).concat([f.serverLimit])},f.gotoPage=function(a){f.page=a},f.linkGroupFirst=function(){var a=Math.max(0,f.linkGroupSize-(f.numPages-1-(f.page+2)));return Math.max(0,f.page-(f.linkGroupSize+a))},f.linkGroupLast=function(){var a=Math.max(0,f.linkGroupSize-(f.page-2));return Math.min(f.numPages-1,f.page+(f.linkGroupSize+a))},f.isFinite=function(){return f.numPages<1/0},f.page=f.page||0,f.autoPresets&&f.updatePresets(),f.$watch("page",function(a,b){if("true"!==f.passive&&a!==b){if(0>a||a*f.perPage>=f.numItems)return;var d=f.perPage||100;f.autoPresets&&(d=c(d)),h({from:a*d,to:(a+1)*d-1})}}),f.$watch("perPage",function(a,b){if("true"!==f.passive&&"number"==typeof b&&a!==b){var c=f.page*b,d=Math.floor(c/a);f.page!==d?f.page=d:h({from:f.page*a,to:(f.page+1)*a-1})}}),f.$watch("serverLimit",function(a,b){"true"!==f.passive&&a!==b&&f.updatePresets()}),f.$watch("url",function(a,b){"true"!==f.passive&&a!==b&&(f.page=0)}),f.$watch("reloadPage",function(a,b){"true"!==f.passive&&a===!0&&b===!1&&(f.reloadPage=!1,h({from:f.page*f.perPage,to:(f.page+1)*f.perPage-1}))});var k=c(f.perPage||100);h({from:f.page*k,to:(f.page+1)*k-1})}]}}).filter("makeRange",function(){return function(a){var b,c;switch(a.length){case 1:b=0,c=parseInt(a[0],10)-1;break;case 2:b=parseInt(a[0],10),c=parseInt(a[1],10);break;default:return a}for(var d=[],e=b;c>=e;e++)d.push(e);return d}})}();